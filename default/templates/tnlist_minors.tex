<<% extends "lists.base.tex" %>>

<<% if not parts %>>
    <<% set parts = EVENT.parts %>>
<<% endif %>>
<<% if not registrations %>>
    <<% set stati = [ENUMS.RegistrationPartStati.participant] %>>
    <<% if CONFIG.tnlist.show_guests_orga %>>
        <<% do stati.append(ENUMS.RegistrationPartStati.guest) %>>
    <<% endif %>>
    <<% set registrations = UTIL.get_registrations(EVENT, parts=parts, stati=stati, minors_only=True) %>>
<<% endif %>>
<<% set title = "MinderjÃ¤hrigenliste " + EVENT.title|e %>>
<<% if parts|length != EVENT.parts|length %>>
    <<% for part in parts %>>
        <<% set title = title + " " + part.title|e %>>
    <<% endfor %>>
<<% endif %>>
<<% set hide_header = True %>>
<<% set portrait = parts|length < 2 and parts[0].days|list|length < 5 %>>

<<% block packages %>>
    \usepackage{amssymb}
<<% endblock %>>

<<% block table_columnspec %>>
    |lll|
        <<% for part in parts %>>
            l|<<< "c|" * (part.end - part.begin).days >>>
        <<% endfor %>>
    l|
<<% endblock %>>

<<% block table_head %>>
    & \head{Vorname} & \head{Nachname}
    <<% for part in parts -%>>
        & \head{Unterkunft<<% if EVENT.parts|length > 1 %>> <<< part.shortname|e >>><<% endif %>>}
        <<% for day in (part.days|list)[:-1] %>>
            & \head{<<< day.strftime("%d.%m.") >>>}
        <<% endfor %>>
    <<% endfor %>>
     & \head{Handy}
<<% endblock %>>

<<% block table_body %>>
    <<% for registration in registrations %>>
        <<% if registration.age_class.is_minor %>>
            \custombox{<<< registration.age_class.name >>>}
        <<% endif %>>
        & <<< registration.name.given_names|e >>> & <<< registration.name.family_name|e >>> &
        <<% for part in parts -%>>
            <<% if registration.parts[part].is_present -%>>
                <<% with lodgement = registration.parts[part].lodgement -%>>
                    <<% if lodgement -%>><<< lodgement.moniker|e >>><<%- endif %>>
                <<%- endwith %>> &
                <<< "$\square$&" * (part.end - part.begin).days >>>
            <<%- else -%>>
                \multicolumn{1}{c|}{---}& <<< "-&" * (part.end - part.begin).days >>>
            <<%- endif %>>
        <<% endfor %>>
        <<< registration.mobile|e >>> \\
        \hline
    <<% endfor %>>
<<% endblock %>>
